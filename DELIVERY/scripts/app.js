var GAME=GAME||{};GAME.camera=new PIXI.Point,GAME.width,GAME.height,GAME.LO_MODE=0,GAME.gameover=1,GAME.trailerOpen=0,GAME.SoundManager=function(){this.isMute=!1,this.currentMusic=null},GAME.SoundManager.prototype.playMusic=function(e){null!=this.currentMusic&&this.currentMusic.stop(),this.currentMusic=createjs.Sound.play(e,createjs.Sound.INTERRUPT_NONE,0,0,-1,.5)},GAME.SoundManager.prototype.playSound=function(e){createjs.Sound.play(e,createjs.Sound.INTERRUPT_ANY,0,0,0)},GAME.SoundManager.prototype.mute=function(){createjs.Sound.setMute(!0),this.isMute=!0},GAME.SoundManager.prototype.unmute=function(){createjs.Sound.setMute(!1),this.isMute=!1},GAME.SoundManager.prototype.toggleMute=function(){this.isMute?this.unmute():this.mute()},GAME.Footer=function(){PIXI.DisplayObjectContainer.call(this);var e=this;this.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame("footer.jpg")));var t=new PIXI.DisplayObjectContainer;this.siteButtonBG=new PIXI.Sprite(PIXI.Texture.fromFrame("footer_website_off.png")),t.addChild(this.siteButtonBG),t.position.x=14,t.position.y=17;var n=new PIXI.Text(GAME.LOCALISED.WEBSITE,{font:"20px Anton",fill:"#000000"});n.position.x=50,n.position.y=8,GAME.isFireFox&&(n.position.y+=7),t.addChild(n);var i=new PIXI.Sprite(PIXI.Texture.fromFrame("footer_website_icon.png"));i.position.x=n.position.x+n.width+10,i.position.y=15,t.addChild(i),this.addChild(t),t.setInteractive(!0),t.buttonMode=!0,t.mousedown=t.touchstart=this.handleSite,GAME.isMobile||(t.mouseover=function(){e.siteButtonBG.setTexture(PIXI.Texture.fromFrame("footer_website_on.png"))},t.mouseout=function(){e.siteButtonBG.setTexture(PIXI.Texture.fromFrame("footer_website_off.png"))});var r=new PIXI.DisplayObjectContainer;this.trailerButtonBG=new PIXI.Sprite(PIXI.Texture.fromFrame("footer_trailer_off.png")),r.addChild(this.trailerButtonBG),r.position.x=601,r.position.y=17;var o=new PIXI.Sprite(PIXI.Texture.fromFrame("footer_trailer_icon.png"));o.position.x=40,o.position.y=11,r.addChild(o);var s=new PIXI.Text(GAME.LOCALISED.TRAILER,{font:"20px Anton",fill:"#000000"});s.position.x=70,s.position.y=8,GAME.isFireFox&&(s.position.y+=7),r.addChild(s),this.addChild(r),r.setInteractive(!0),r.buttonMode=!0,r.mousedown=r.touchstart=this.handleTrailer,GAME.isMobile||(r.mouseover=function(){e.trailerButtonBG.setTexture(PIXI.Texture.fromFrame("footer_trailer_on.png"))},r.mouseout=function(){e.trailerButtonBG.setTexture(PIXI.Texture.fromFrame("footer_trailer_off.png"))});var a=new PIXI.Text(GAME.LOCALISED.CTA,{font:"italic 14px Titillium Web",fill:"#ffffff",align:"center"});a.position.x=390,a.position.y=18,GAME.isFireFox&&(a.position.y+=6),this.addChild(a),this.facebook=new PIXI.Sprite(PIXI.Texture.fromFrame("facebook_off.png")),this.facebook.position.x=497,this.facebook.position.y=24,this.facebook.setInteractive(!0),this.facebook.buttonMode=!0,this.facebook.mousedown=this.facebook.touchstart=this.handleFacebook,this.addChild(this.facebook),GAME.isMobile||(this.facebook.mouseover=function(){e.facebook.setTexture(PIXI.Texture.fromFrame("facebook_on.png"))},this.facebook.mouseout=function(){e.facebook.setTexture(PIXI.Texture.fromFrame("facebook_off.png"))}),this.twitter=new PIXI.Sprite(PIXI.Texture.fromFrame("twitter_off.png")),this.twitter.position.x=549,this.twitter.position.y=22,this.twitter.setInteractive(!0),this.twitter.buttonMode=!0,this.twitter.mousedown=this.twitter.touchstart=this.handleTwitter,GAME.isMobile||(this.twitter.mouseover=function(){e.twitter.setTexture(PIXI.Texture.fromFrame("twitter_on.png"))},this.twitter.mouseout=function(){e.twitter.setTexture(PIXI.Texture.fromFrame("twitter_off.png"))}),this.addChild(this.twitter);var l=new PIXI.Text(GAME.LOCALISED.COPYRIGHT,{font:"italic 9px Titillium Web",fill:"#87878d"});l.anchor.x=1,l.position.x=GAME.width-8,l.position.y=62,this.addChild(l)},GAME.Footer.constructor=GAME.Footer,GAME.Footer.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Footer.prototype.handleFacebook=function(){window.open(GAME.LOCALISED.FACEBOOK_LINK,"_blank"),ga("send","event","Game","Facebook","Footer")},GAME.Footer.prototype.handleTwitter=function(){window.open(GAME.LOCALISED.TWITTER_LINK,"_blank"),ga("send","event","Game","Twitter","Footer")},GAME.Footer.prototype.handleSite=function(){window.open(GAME.LOCALISED.WEBSITE_LINK,"_blank"),ga("send","event","Game","Official Site","Footer")},GAME.Footer.prototype.handleTrailer=function(){GAME.openTrailer(),ga("send","event","Game","Trailer","Footer")},GAME.View=function(e){var t=this;this.engine=e,this.renderer=PIXI.autoDetectRenderer(800,480),this.stage=new PIXI.Stage(0,!0),this.container=new PIXI.DisplayObjectContainer,this.container.setInteractive(!0),this.container.mousedown=this.container.touchstart=function(){GAME.onTouch()},this.platformView=!1,this.hud=new PIXI.DisplayObjectContainer,this.progressbar=new GAME.ProgressBar(this.engine),this.hud.addChild(this.progressbar),this.tutorial=new GAME.Tutorial(this.engine),this.soundButton=new PIXI.DisplayObjectContainer,this.soundOn=new PIXI.Sprite(PIXI.Texture.fromFrame("sound_on.png")),this.soundOff=new PIXI.Sprite(PIXI.Texture.fromFrame("sound_off.png")),this.soundOff.position.x=0,this.soundOff.position.y=3,this.soundButton.addChild(this.soundOn),this.soundButton.position.x=GAME.width-40,this.soundButton.position.y=10,this.soundButton.setInteractive(!0),this.soundButton.buttonMode=!0,this.soundButton.mousedown=this.soundButton.touchstart=function(){t.soundToggle()},this.hud.addChild(this.soundButton),this.screens=new PIXI.DisplayObjectContainer,this.whiteFill=new PIXI.Sprite(PIXI.Texture.fromFrame("white_block.png")),this.whiteFill.anchor.x=.25,this.whiteFill.anchor.y=.25,this.whiteFill.width=2*GAME.width,this.whiteFill.height=2*GAME.height,this.blackFill=new PIXI.Sprite(PIXI.Texture.fromFrame("black_block.png")),this.blackFill.anchor.x=.25,this.blackFill.anchor.y=.25,this.blackFill.width=2*GAME.width,this.blackFill.height=2*GAME.height,this.footer=new GAME.Footer(e),this.footer.position.y=405,this.hud.addChild(this.footer),this.gameBG=new PIXI.DisplayObjectContainer,this.gameMG=new PIXI.DisplayObjectContainer,this.gameFG=new PIXI.DisplayObjectContainer,this.fade=new PIXI.DisplayObjectContainer,this.playerHolder=new PIXI.DisplayObjectContainer,this.container.addChild(this.gameBG),this.container.addChild(this.gameMG),this.container.addChild(this.gameFG),this.container.addChild(this.playerHolder),this.container.addChild(this.fade),this.container.addChild(this.screens),this.stage.addChild(this.container),this.stage.addChild(this.hud),this.backgroundManager=new GAME.BackgroundManager(this.engine),this.gameBG.addChild(this.backgroundManager),this.fade.addChild(this.blackFill)},GAME.View.constructor=GAME.View,GAME.View.prototype.update=function(){GAME.gameover||GAME.pause||this.progressbar.update(),this.renderer.render(this.stage)},GAME.View.prototype.reset=function(){this.backgroundManager.reset(),this.gameFG.position.y=0,this.playerHolder.position.y=0,this.backgroundManager.middistance.position.y=0,this.platformView=!1,this.fade.removeChild(this.blackFill)},GAME.View.prototype.resize=function(e,t){GAME.width=e,GAME.height=t,this.renderer.resize(e,t),this.backgroundManager.width=e,this.progressbar.position.x=(e-this.progressbar.width)/2,this.footer.position.x=(e-800)/2,this.screens.position.x=(e-800)/2,this.soundButton.position.x=e-40,this.tutorial.resize()},GAME.View.prototype.soundToggle=function(){this.engine.soundManager.toggleMute(),this.engine.soundManager.isMute?(this.soundButton.removeChild(this.soundOn),this.soundButton.addChild(this.soundOff)):(this.soundButton.removeChild(this.soundOff),this.soundButton.addChild(this.soundOn))},GAME.View.prototype.flashScreen=function(){var e=this;this.fade.addChild(this.whiteFill),TweenMax.to(this.whiteFill,.5,{alpha:0,delay:.2,onComplete:function(){e.fade.removeChild(e.whiteFill),e.whiteFill.alpha=1}})},GAME.View.prototype.toPlatformView=function(){this.platformView=!0,TweenMax.to(this.gameFG.position,1,{y:150,delay:0}),TweenMax.to(this.gameMG.position,1,{y:150,delay:0}),TweenMax.to(this.playerHolder.position,1,{y:150,delay:0}),TweenMax.to(this.backgroundManager.middistance.position,1,{y:150,delay:0}),TweenMax.to(this.backgroundManager.train.position,1,{y:321,delay:0})},GAME.View.prototype.toNormalView=function(){this.platformView=!1,TweenMax.to(this.gameFG.position,1,{y:0,delay:0}),TweenMax.to(this.gameMG.position,1,{y:0,delay:0}),TweenMax.to(this.playerHolder.position,1,{y:0,delay:0}),TweenMax.to(this.backgroundManager.middistance.position,1,{y:0,delay:0}),TweenMax.to(this.backgroundManager.train.position,1,{y:171,delay:0})},GAME.ProgressBar=function(e){PIXI.DisplayObjectContainer.call(this),this.engine=e,this.position.y=-100,this.BULLET_START=4,this.BAR_MAX=285,this.time=0,this.last_time=0;var t=PIXI.Texture.fromFrame("progress_bar.png");this.width=t.width,this.addChild(new PIXI.Sprite(t)),this.position.x=Math.round((GAME.width-this.width)/2),this.distanceText=new PIXI.Text(GAME.LOCALISED.DISTANCE+":",{font:"20px Anton",fill:"#f26622",stroke:"#333333",strokeThickness:4}),this.distanceText.anchor.x=0,this.distanceText.anchor.y=0,this.distanceText.position.x=12,this.distanceText.position.y=17,GAME.isFireFox&&(this.distanceText.position.y+=7),this.addChild(this.distanceText),this.timeText=new PIXI.Text(GAME.LOCALISED.TIME+":",{font:"20px Anton",fill:"#f26622",stroke:"#333333",strokeThickness:4}),this.timeText.anchor.x=1,this.timeText.anchor.y=0,this.timeText.position.x=470,this.timeText.position.y=17,GAME.isFireFox&&(this.timeText.position.y+=7),this.addChild(this.timeText),this.timeDisplay=new PIXI.Text("0:00",{font:"38px Anton",fill:"#ffffff",stroke:"#333333",strokeThickness:4}),this.timeDisplay.anchor.x=0,this.timeDisplay.anchor.y=0,this.timeDisplay.position.x=475,this.timeDisplay.position.y=4,GAME.isFireFox&&(this.timeDisplay.position.y+=13),this.addChild(this.timeDisplay);var n=new PIXI.DisplayObjectContainer;n.position.x=106,n.position.y=15;var i=new PIXI.Sprite(PIXI.Texture.fromFrame("bar_inner_left.png"));i.position.x=0,i.position.y=12,n.addChild(i),this.bar=new PIXI.Sprite(PIXI.Texture.fromFrame("bar_inner.png")),this.bar.position.x=2,this.bar.position.y=11,this.bar.width=1,n.addChild(this.bar),this.bullet=new PIXI.Sprite(PIXI.Texture.fromFrame("silver_bullet.png")),this.bullet.position.y=0,this.bullet.position.x=this.BULLET_START,n.addChild(this.bullet),this.addChild(n)},GAME.ProgressBar.constructor=GAME.ProgressBar,GAME.ProgressBar.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.ProgressBar.prototype.update=function(){this.setProgress((this.engine.player.position.x/10-GAME_MILESTONES[1])/GAME.GOAL_DISTANCE),this.last_time!=this.time&&(this.timeDisplay.setText(Math2.formatTime(this.time)),this.last_time=this.time)},GAME.ProgressBar.prototype.reset=function(){this.time=0,this.timeDisplay.setText("0:00"),window.clearInterval(this.timer)},GAME.ProgressBar.prototype.show=function(){TweenMax.to(this.position,.5,{y:0})},GAME.ProgressBar.prototype.hide=function(){TweenMax.to(this.position,.5,{y:-100})},GAME.ProgressBar.prototype.setProgress=function(e){var e=e>1?1:e;e=0>e?0:e,this.bar.width=Math.round(this.BAR_MAX*e),this.bullet.position.x=Math.round(this.BAR_MAX*e+this.BULLET_START-this.bullet.width)},GAME.ProgressBar.prototype.startTime=function(){var e=this;this.timer=window.setInterval(function(){GAME.pause||GAME.gameover||(e.time+=100)},1e3)},GAME.ProgressBar.prototype.stopTime=function(){window.clearInterval(this.timer)},GAME.Message=function(e,t,n){PIXI.DisplayObjectContainer.call(this);var i=this;this.bg=t?new PIXI.MovieClip([PIXI.Texture.fromFrame("brush_stroke.swf/0000"),PIXI.Texture.fromFrame("brush_stroke.swf/0001"),PIXI.Texture.fromFrame("brush_stroke.swf/0002"),PIXI.Texture.fromFrame("brush_stroke.swf/0003"),PIXI.Texture.fromFrame("brush_stroke.swf/0004")]):new PIXI.MovieClip([PIXI.Texture.fromFrame("brush_stroke.swf/0000"),PIXI.Texture.fromFrame("brush_stroke.swf/0001"),PIXI.Texture.fromFrame("brush_stroke.swf/0002"),PIXI.Texture.fromFrame("brush_stroke.swf/0003"),PIXI.Texture.fromFrame("brush_stroke.swf/0004"),PIXI.Texture.fromFrame("brush_stroke.swf/0005"),PIXI.Texture.fromFrame("brush_stroke.swf/0006"),PIXI.Texture.fromFrame("brush_stroke.swf/0007"),PIXI.Texture.fromFrame("brush_stroke.swf/0008"),PIXI.Texture.fromFrame("brush_stroke.swf/0009"),PIXI.Texture.fromFrame("brush_stroke.swf/0010")]),this.bg.animationSpeed=.5,this.bg.anchor.x=t?.38:.5,this.bg.anchor.y=.5,this.bg.position.x=GAME.width/2,this.bg.position.y=GAME.height/2-20,this.bg.loop=!1,this.bg.play(),this.addChild(this.bg),n?(this.bg.onComplete=function(){i.showStart()},this.oneText=new PIXI.Text("1",{font:"38px Anton",fill:"#000000"}),this.oneText.anchor.x=.5,this.oneText.anchor.y=.5,this.oneText.position.x=Math.round(GAME.width/2),this.oneText.position.y=Math.round(GAME.height/2)-18,GAME.isFireFox&&(this.oneText.position.y+=13),this.oneText.alpha=0,this.addChild(this.oneText),this.twoText=new PIXI.Text("2",{font:"38px Anton",fill:"#000000"}),this.twoText.anchor.x=.5,this.twoText.anchor.y=.5,this.twoText.position.x=Math.round(GAME.width/2),this.twoText.position.y=Math.round(GAME.height/2)-18,GAME.isFireFox&&(this.twoText.position.y+=13),this.twoText.alpha=0,this.addChild(this.twoText),this.threeText=new PIXI.Text("3",{font:"38px Anton",fill:"#000000"}),this.threeText.anchor.x=.5,this.threeText.anchor.y=.5,this.threeText.position.x=Math.round(GAME.width/2),this.threeText.position.y=Math.round(GAME.height/2)-18,GAME.isFireFox&&(this.threeText.position.y+=13),this.threeText.alpha=0,this.addChild(this.threeText),this.messageText=new PIXI.Text(e,{font:"38px Anton",fill:"#000000"}),this.messageText.anchor.x=.5,this.messageText.anchor.y=.5,this.messageText.position.x=Math.round(GAME.width/2),this.messageText.position.y=Math.round(GAME.height/2)-18,GAME.isFireFox&&(this.messageText.position.y+=13),this.messageText.alpha=0,this.addChild(this.messageText)):(this.bg.onComplete=function(){i.showText()},this.messageText=new PIXI.Text(e,{font:"38px Anton",fill:"#000000"}),this.messageText.anchor.x=.5,this.messageText.anchor.y=.5,this.messageText.position.x=Math.round(GAME.width/2),this.messageText.position.y=Math.round(GAME.height/2)-18,GAME.isFireFox&&(this.messageText.position.y+=13),this.messageText.alpha=0,this.addChild(this.messageText))},GAME.Message.constructor=GAME.Message,GAME.Message.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Message.prototype.showStart=function(){var e=this;TweenMax.to(this.threeText,0,{startAt:{alpha:1}}),TweenMax.to(this.threeText.scale,.2,{x:1,y:1,startAt:{x:2,y:2}}),TweenMax.to(this.threeText.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.2}),TweenMax.to(this.bg.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.2,onComplete:function(){e.removeText(e.threeText)}}),TweenMax.to(this.twoText,0,{startAt:{alpha:1},delay:.6}),TweenMax.to(this.twoText.scale,.2,{x:1,y:1,startAt:{x:2,y:2},delay:.6}),TweenMax.to(this.twoText.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.8}),TweenMax.to(this.bg.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.8,onComplete:function(){e.removeText(e.twoText)}}),TweenMax.to(this.oneText,0,{startAt:{alpha:1},delay:1.2}),TweenMax.to(this.oneText.scale,.2,{x:1,y:1,startAt:{x:2,y:2},delay:1.2}),TweenMax.to(this.oneText.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:1.4}),TweenMax.to(this.bg.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:1.4,onComplete:function(){e.removeText(e.oneText)}}),TweenMax.to(this.messageText,0,{startAt:{alpha:1},delay:1.8}),TweenMax.to(this.messageText.scale,.2,{x:1,y:1,startAt:{x:2,y:2},delay:1.8}),TweenMax.to(this.messageText.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:2}),TweenMax.to(this.bg.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:2,onComplete:function(){e.removeMessage()}})},GAME.Message.prototype.removeText=function(e){TweenMax.to(e,.3,{alpha:0})},GAME.Message.prototype.showText=function(){var e=this;this.messageText.alpha=1,TweenMax.to(this.messageText.scale,.2,{x:1,y:1,startAt:{x:2,y:2}}),TweenMax.to(this.messageText.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.2}),TweenMax.to(this.bg.scale,.1,{x:1,y:1,startAt:{x:.9,y:.9},delay:.2,onComplete:function(){e.removeMessage()}})},GAME.Message.prototype.removeMessage=function(){var e=this;TweenMax.to(this,.5,{alpha:0,delay:1,onComplete:function(){e.destroy()}})},GAME.Message.prototype.destroy=function(){this.parent.removeChild(this)},GAME.Tutorial=function(e){PIXI.DisplayObjectContainer.call(this),this.engine=e,this.tutorialIndex=0,this.tutorialCopy=GAME.isMobile?[GAME.LOCALISED.TUTORIAL_1,GAME.LOCALISED.TUTORIAL_2,GAME.LOCALISED.TUTORIAL_3_MOBILE,GAME.LOCALISED.TUTORIAL_4]:[GAME.LOCALISED.TUTORIAL_1,GAME.LOCALISED.TUTORIAL_2,GAME.LOCALISED.TUTORIAL_3,GAME.LOCALISED.TUTORIAL_4],this.bgTexture=PIXI.Texture.fromFrame("intro_panel.png");var t=new PIXI.Sprite(this.bgTexture);this.addChild(t);var n=new PIXI.Text(GAME.LOCALISED.TUTORIAL_TITLE,{font:"33px Anton",fill:"#ffffff",stroke:"#666666",strokeThickness:4});n.position.x=Math.round((this.bgTexture.width-n.width)/2),n.position.y=10,GAME.isFireFox&&(n.position.y+=13),this.addChild(n),this.instructionText=new PIXI.Text(this.tutorialCopy[0],{font:"bold italic 19px Titillium Web",fill:"#000000"}),this.instructionText.position.x=20,this.instructionText.position.y=60,GAME.isFireFox&&(this.instructionText.position.y+=8),this.addChild(this.instructionText);var i;i=GAME.isMobile?GAME.LOCALISED.CONTINUE_MOBILE:GAME.LOCALISED.CONTINUE,this.continueText=new PIXI.Text(i,{font:"bold italic 20px Titillium Web",fill:"#000000"}),this.continueText.position.x=this.bgTexture.width-20,this.continueText.position.y=160,this.continueText.anchor.x=1,GAME.isFireFox&&(this.continueText.position.y+=8),this.addChild(this.continueText),this.position.x=Math.round((GAME.width-this.bgTexture.width)/2),this.position.y=Math.round((GAME.height-this.bgTexture.height)/2)-20},GAME.Tutorial.constructor=GAME.Tutorial,GAME.Tutorial.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Tutorial.prototype.skip=function(){var e=this;TweenMax.to(this.continueText,.3,{alpha:0}),TweenMax.to(this.instructionText,.3,{alpha:0,onComplete:function(){e.swapToNext()}})},GAME.Tutorial.prototype.swapToNext=function(){this.tutorialIndex++,this.tutorialIndex<this.tutorialCopy.length?(this.instructionText.setText(this.tutorialCopy[this.tutorialIndex]),TweenMax.to(this.continueText,.3,{alpha:1}),TweenMax.to(this.instructionText,.3,{alpha:1})):(this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.GO,!0,!0)),this.engine.sectionManager.setMilestones(),this.engine.player.cutScene=0,GAME.tutorial=0,GAME.seenTutorial=1,this.destroy())},GAME.Tutorial.prototype.resize=function(){this.position.x=Math.round((GAME.width-this.bgTexture.width)/2),this.position.y=Math.round((GAME.height-this.bgTexture.height)/2)-20},GAME.Tutorial.prototype.destroy=function(){this.parent.removeChild(this)},GAME.Player=function(e){this.engine=e,this.position=new PIXI.Point,this.onGround=1,this.isJumping=0,this.wasJumping=0,this.isFalling=0,this.dead=0,this.cutScene=0,this.position.y=345,this.position.x=0,this.currentAnimSpeed=.3,this.gravity=.4,this.acceleration=.08,this.baseSpeed=4,this.maxSpeed=12,this.speed=new PIXI.Point(this.baseSpeed,0),this.width=220,this.height=90,this.rangerRunning=[PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0000"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0001"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0002"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0003"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0004"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0005"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0006"),PIXI.Texture.fromFrame("silver_run_final_75_percent.swf/0007")],this.rangerJumping=[PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0000"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0001"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0002"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0003"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0004"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0005"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0006"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0007"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0008"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0009"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0010"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0011"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0012"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0013"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0014"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0015"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0016"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0017"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0018"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0019"),PIXI.Texture.fromFrame("silver_jump_final_75percent.swf/0020")],this.rangerFalling=[PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0000"),PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0001"),PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0002"),PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0003"),PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0004"),PIXI.Texture.fromFrame("silver_fall_final_75percent.swf/0005")],this.soloRunning=[PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0000"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0001"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0002"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0003"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0004"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0005"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0006"),PIXI.Texture.fromFrame("silver_run_final_solo_75percent.swf/0007")],this.soloJumping=[PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0000"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0001"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0002"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0003"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0004"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0005"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0006"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0007"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0008"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0009"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0010"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0011"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0012"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0013"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0014"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0015"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0016"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0017"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0018"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0019"),PIXI.Texture.fromFrame("silver_jump_final_solo_75percent.swf/0020")],this.soloFalling=[PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0000"),PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0001"),PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0002"),PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0003"),PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0004"),PIXI.Texture.fromFrame("silver_fall_final_solo_75percent.swf/0005")],this.runningFrames=this.soloRunning,this.jumpingFrames=this.soloJumping,this.fallingFrames=this.soloFalling,this.view=new PIXI.MovieClip(this.runningFrames),this.view.anchor.x=.5,this.view.anchor.y=1,this.view.animationSpeed=this.currentAnimSpeed,this.view.position.x=this.position.x,this.view.position.y=this.position.y},GAME.Player.constructor=GAME.Player,GAME.Player.prototype.jump=function(){!this.onGround||GAME.gameover||this.cutScene||(this.isJumping=1,this.wasJumping=1,this.onGround=0,this.onGround=0,this.speed.y=-9.3,this.view.stop(),this.view.currentFrame=0,this.view.textures=this.jumpingFrames,this.view.animationSpeed=.45,this.view.loop=!1,this.view.play())},GAME.Player.prototype.jumpComplete=function(){this.view.stop(),this.view.currentFrame=14,this.view.textures=this.runningFrames,this.view.animationSpeed=this.currentAnimSpeed,this.view.loop=!0,this.view.play(),this.onGround=1,this.wasJumping=0,this.isFalling=0},GAME.Player.prototype.fall=function(){this.view.animationSpeed=.1},GAME.Player.prototype.hitObstacle=function(){this.speed.x=this.baseSpeed,TweenMax.to(this.view,.05,{alpha:.3,yoyo:!0,repeat:5,overwrite:"all",startAt:{alpha:1}})},GAME.Player.prototype.hitWall=function(){var e=this;this.dead=1,this.speed.x=this.baseSpeed,this.onGround=0,this.wasJumping=0,this.isFalling=0,this.view.stop(),this.view.currentFrame=0,this.view.textures=this.fallingFrames,this.view.animationSpeed=.4,this.view.loop=!1,this.view.onComplete=function(){e.view.onComplete=null,e.engine.onGameOver()},this.view.play()},GAME.Player.prototype.pickupRanger=function(){this.view.stop(),this.runningFrames=this.rangerRunning,this.jumpingFrames=this.rangerJumping,this.fallingFrames=this.rangerFalling,this.view.textures=this.runningFrames,this.view.play()},GAME.Player.prototype.dropOffRanger=function(){this.view.stop(),this.runningFrames=this.soloRunning,this.jumpingFrames=this.soloJumping,this.fallingFrames=this.soloFalling,this.view.textures=this.runningFrames,this.view.play()},GAME.Player.prototype.update=function(){this.dead||(this.cutScene&&this.onGround||(this.speed.y+=this.gravity),this.speed.y>0&&this.isJumping&&(this.isJumping=0),this.cutScene||(this.onGround?this.speed.x<this.maxSpeed&&(this.speed.x+=this.acceleration):this.wasJumping||this.isFalling||(this.isFalling=1,this.fall())),this.position.y-this.height-40>GAME.height&&this.engine.onGameOver(),this.position.x+=this.speed.x,this.position.y+=this.speed.y,GAME.camera.x=this.position.x-100,this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y-GAME.camera.y)},GAME.Player.prototype.reset=function(){this.onGround=1,this.isJumping=0,this.wasJumping=0,this.isFalling=0,this.dead=0,this.cutScene=0,this.maxSpeed=12,this.currentAnimSpeed=.3,this.dropOffRanger(),this.position.x=0,this.position.y=345,this.speed.y=0,this.speed.x=this.baseSpeed,this.view.textures=this.runningFrames,this.view.loop=!0,this.view.animationSpeed=this.currentAnimSpeed,this.view.play(),GAME.camera.x=this.position.x-100,this.view.position.x=this.position.x-GAME.camera.x,this.view.position.y=this.position.y-GAME.camera.y},GAME.Tonto=function(e){this.engine=e,this.position=new PIXI.Point,this.position.y=355,this.position.x=-100,this.currentAnimSpeed=.3,this.baseSpeed=4,this.speed=new PIXI.Point(this.baseSpeed,0),this.runningFrames=[PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0000"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0001"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0002"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0003"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0004"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0005"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0006"),PIXI.Texture.fromFrame("scout_run_final_75percent.swf/0007")],this.view=new PIXI.MovieClip(this.runningFrames),this.view.anchor.x=.5,this.view.anchor.y=1,this.view.animationSpeed=this.currentAnimSpeed,this.view.position.x=this.position.x,this.view.position.y=this.position.y},GAME.Tonto.constructor=GAME.Tonto,GAME.Tonto.prototype.catchUp=function(){this.view.play(),TweenMax.to(this.view.position,2,{x:40,delay:3})},GAME.Tonto.prototype.fallBack=function(){var e=this;TweenMax.to(this.view.position,2,{x:-100,delay:3,onComplete:function(){e.view.stop()}})},GAME.Tonto.prototype.reset=function(){TweenMax.killTweensOf(this.view.position),this.view.position.x=-100,this.view.animationSpeed=this.currentAnimSpeed},GAME.Train=function(e){PIXI.DisplayObjectContainer.call(this),this.engine=e,this.carriages=[],this.wheelFrames=[PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0000"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0001"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0002"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0003"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0004"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0005"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0006"),PIXI.Texture.fromFrame("train_running_gear_75percent.swf/0007")];var t;t=new GAME.TrainCarriage("second"),this.addChild(t),this.carriages.push(t),this.ranger=new PIXI.Sprite(PIXI.Texture.fromFrame("ranger_train.png")),this.ranger.position.x=-12,this.ranger.position.y=36,this.ranger.alpha=0,t.addChild(this.ranger),t=new GAME.TrainCarriage("first"),t.position.x=t.position.x+t.width-33,this.addChild(t),this.carriages.push(t),this.tender_body=new PIXI.Sprite(PIXI.Texture.fromFrame("coal_tender.png")),this.tender_body.position.x=t.position.x+t.width-25,this.tender_body.position.y=35,this.addChild(this.tender_body),this.running_gear=new PIXI.MovieClip(this.wheelFrames),this.running_gear.animationSpeed=.35,this.running_gear.play(),this.addChild(this.running_gear),this.ranger2=new PIXI.Sprite(PIXI.Texture.fromFrame("ranger_train.png")),this.ranger2.position.x=30,this.ranger2.position.y=-44,this.ranger2.alpha=0,this.running_gear.addChild(this.ranger2),this.engine_body=new PIXI.Sprite(PIXI.Texture.fromFrame("locomotive.png")),this.engine_body.position.x=this.tender_body.position.x+this.tender_body.width-52,this.running_gear.position.x=this.engine_body.position.x-40,this.running_gear.position.y=82,this.addChild(this.engine_body)},GAME.Train.constructor=GAME.Train,GAME.Train.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Train.prototype.reset=function(){for(var e=0;this.carriages.length>e;e++)this.carriages[e].reflection.play();this.running_gear.animationSpeed=.35,this.ranger.alpha=0,this.ranger2.alpha=0},GAME.Train.prototype.slowDown=function(){for(var e=0;this.carriages.length>e;e++)this.carriages[e].reflection.stop()},GAME.TrainCarriage=function(e){return PIXI.DisplayObjectContainer.call(this),this.firstclassreflectionFrames=[PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0000"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0001"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0002"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0003"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0004"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0005"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0006"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0007"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0008"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0009"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0010"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0011"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0012"),PIXI.Texture.fromFrame("carriage_reflections_1st_class.swf/0013")],this.secondclassreflectionFrames=[PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0000"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0001"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0002"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0003"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0004"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0005"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0006"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0007"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0008"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0009"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0010"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0011"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0012"),PIXI.Texture.fromFrame("carriage_reflections_2nd_class.swf/0013")],"first"==e?(this.carriage_body=new PIXI.Sprite(PIXI.Texture.fromFrame("carriage_1st_class.png")),this.carriage_body.position.x=0,this.carriage_body.position.y=-2,this.addChild(this.carriage_body),this.reflection=new PIXI.MovieClip(this.firstclassreflectionFrames),this.reflection.animationSpeed=.35,this.reflection.position.x=2,this.reflection.position.y=-4,this.reflection.play(),this.addChild(this.reflection)):(this.carriage_body=new PIXI.Sprite(PIXI.Texture.fromFrame("carriage_2nd_class.png")),this.carriage_body.position.x=0,this.carriage_body.position.y=8,this.addChild(this.carriage_body),this.reflection=new PIXI.MovieClip(this.secondclassreflectionFrames),this.reflection.animationSpeed=.35,this.reflection.position.x=2,this.reflection.position.y=10,this.reflection.play(),this.addChild(this.reflection)),this.width=this.carriage_body.width,this
},GAME.TrainCarriage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.FloorFactory=function(){this.floorPool=new GAME.ObjectPool(GAME.Floor),this.trackPool=new GAME.ObjectPool(GAME.Track),this.floorLeftPool=new GAME.ObjectPool(GAME.FloorLeft),this.floorRightPool=new GAME.ObjectPool(GAME.FloorRight),this.bridgePool=new GAME.ObjectPool(GAME.Bridge)},GAME.FloorFactory.constructor=GAME.FloorFactory,GAME.FloorFactory.prototype.getFloor=function(){var e=this.floorPool.getObject();return e},GAME.FloorFactory.prototype.getTrack=function(){var e=this.trackPool.getObject();return e},GAME.FloorFactory.prototype.getBridge=function(){var e=this.bridgePool.getObject();return e},GAME.FloorFactory.prototype.getFloorCap=function(e){var t;return t="left"==e?this.floorLeftPool.getObject():this.floorRightPool.getObject()},GAME.Floor=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame("floor_tile.png")),this.collidable=1},GAME.Floor.constructor=GAME.Floor,GAME.Floor.prototype=Object.create(PIXI.Sprite.prototype),GAME.FloorLeft=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame("floor_face_left.png")),this.anchor.x=.6,this.collidable=0},GAME.FloorLeft.constructor=GAME.FloorLeft,GAME.FloorLeft.prototype=Object.create(PIXI.Sprite.prototype),GAME.FloorRight=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame("floor_face_right.png")),this.anchor.x=.3,this.collidable=0},GAME.FloorRight.constructor=GAME.FloorRight,GAME.FloorRight.prototype=Object.create(PIXI.Sprite.prototype),GAME.Bridge=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame("bridge.png")),this.collidable=0},GAME.Bridge.constructor=GAME.Bridge,GAME.Bridge.prototype=Object.create(PIXI.Sprite.prototype),GAME.Track=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame("track.png")),this.collidable=0,this.anchor.y=.5},GAME.Track.constructor=GAME.Track,GAME.Track.prototype=Object.create(PIXI.Sprite.prototype),GAME.PlatformFactory=function(){GAME.platformTextures=[],this.townTextures=["house1.png","house2.png","house3.png","house4.png","long_house.png"],this.canyonTextures=["canyon_platform_small.png","canyon_platform_medium.png","canyon_platform_large.png"],this.platformPool=new GAME.ObjectPool(GAME.Platform)},GAME.PlatformFactory.constructor=GAME.PlatformFactory,GAME.PlatformFactory.prototype.setTextures=function(e){switch(e){case GAME_LEVEL.TOWN:GAME.platformTextures=this.townTextures;break;case GAME_LEVEL.CANYONS:GAME.platformTextures=this.canyonTextures}},GAME.PlatformFactory.prototype.getPlatform=function(){var e=this.platformPool.getObject();return e},GAME.PlatformFactory.prototype.getStepUp=function(){var e,t;if(GAME.platformTextures===this.townTextures&&(e=new PIXI.Sprite(PIXI.Texture.fromFrame("crates.png")),e.anchor.x=0,e.anchor.y=1,e.hitHeight=e.height+5,t=new PIXI.Sprite(PIXI.Texture.fromFrame("hay_barn.png")),t.anchor.x=0,t.anchor.y=1,t.hitHeight=t.height+5),GAME.platformTextures===this.canyonTextures){e=new PIXI.DisplayObjectContainer;var n=new PIXI.Sprite(PIXI.Texture.fromFrame("canyon_platform_loop.png"));n.position.x=80,n.position.y=-80;var i=new PIXI.Sprite(PIXI.Texture.fromFrame("canyon_step_up.png"));i.position.y=-80,i.position.x=-20,e.addChild(n),e.addChild(i),e.hitHeight=80,e.width=400,t=new PIXI.DisplayObjectContainer;var n=new PIXI.Sprite(PIXI.Texture.fromFrame("canyon_platform_loop.png"));n.position.x=80,n.position.y=-160;var i=new PIXI.Sprite(PIXI.Texture.fromFrame("canyon_step_up.png"));i.position.y=-160,i.position.x=-20;var r=new PIXI.Sprite(PIXI.Texture.fromFrame("canyon_end_right1.png"));r.position.y=-160,r.position.x=n.width-60,t.addChild(n),t.addChild(i),t.addChild(r),t.hitHeight=160,t.width=n.width+150}var o={step1:e,step2:t};return o},GAME.Platform=function(){var e=GAME.platformTextures[Math2.randomInt(0,GAME.platformTextures.length-1)];switch(PIXI.Sprite.call(this,PIXI.Texture.fromFrame(e)),this.anchor.x=0,this.anchor.y=1,e){case"house1.png":this.hitHeight=133;break;case"house2.png":this.hitHeight=195;break;case"house3.png":this.hitHeight=195;break;case"house4.png":this.hitHeight=225;break;case"long_house.png":this.hitHeight=183;break;default:this.hitHeight=this.height}},GAME.Platform.constructor=GAME.Platform,GAME.Platform.prototype=Object.create(PIXI.Sprite.prototype),GAME.BackgroundFactory=function(){GAME.backgroundTextures=[],this.desertTextures=[],this.townTextures=["bg_town_house1.png","bg_town_house2.png","bg_town_house3.png","bg_town_house4.png","bg_town_house5.png","bg_town_house6.png","bg_town_house7.png","bg_town_house8.png","corral.png","gallows.png"],this.indianTextures=["tipi_closed.png","tipi_open.png","tipi_partial.png","tipi_group.png"],this.backgroundPool=new GAME.ObjectPool(GAME.BackgroundItem),this.setTextures(GAME_LEVEL.TOWN)},GAME.BackgroundFactory.constructor=GAME.BackgroundFactory,GAME.BackgroundFactory.prototype.getBackground=function(){var e=this.backgroundPool.getObject();return e},GAME.BackgroundFactory.prototype.getTrainStation=function(){var e=new PIXI.Sprite(PIXI.Texture.fromFrame("train_station.png"));return e.anchor.x=0,e.anchor.y=1,e},GAME.BackgroundFactory.prototype.setTextures=function(e){switch(e){case GAME_LEVEL.DESERT:GAME.backgroundTextures=this.desertTextures;break;case GAME_LEVEL.INDIAN_VILLAGE:GAME.backgroundTextures=this.indianTextures;break;case GAME_LEVEL.TOWN:GAME.backgroundTextures=this.townTextures}},GAME.BackgroundItem=function(){PIXI.Sprite.call(this,PIXI.Texture.fromFrame(GAME.backgroundTextures[Math2.randomInt(0,GAME.backgroundTextures.length-1)])),this.anchor.x=0,this.anchor.y=1},GAME.BackgroundItem.constructor=GAME.BackgroundItem,GAME.BackgroundItem.prototype=Object.create(PIXI.Sprite.prototype),GAME.ObstacleFactory=function(){GAME.obstacleTextures=[],GAME.largeObstacleTextures=[],this.desertTextures=["bush4.png","bush5.png","rock1.png","rock2.png"],this.largeDesertTextures=["large_rock.png","wall.png"],this.indianTextures=["bush4.png","bush5.png","rock1.png","rock2.png","fire.png"],this.largeIndianTextures=["large_rock.png","wall.png"],this.townTextures=["bales.png","barrels.png","box.png","sack.png"],this.largeTownTextures=["crate.png","cart.png"],this.obstaclePool=new GAME.ObjectPool(GAME.ObstacleItem),this.largeObstaclePool=new GAME.ObjectPool(GAME.LargeObstacleItem)},GAME.ObstacleFactory.constructor=GAME.ObstacleFactory,GAME.ObstacleFactory.prototype.getObstacle=function(){var e=this.obstaclePool.getObject();return e},GAME.ObstacleFactory.prototype.getLargeObstacle=function(){var e=this.largeObstaclePool.getObject();return e},GAME.ObstacleFactory.prototype.setTextures=function(e){switch(e){case GAME_LEVEL.DESERT:GAME.obstacleTextures=this.desertTextures,GAME.largeObstacleTextures=this.largeDesertTextures;break;case GAME_LEVEL.INDIAN_VILLAGE:GAME.obstacleTextures=this.indianTextures,GAME.largeObstacleTextures=this.largeIndianTextures;break;case GAME_LEVEL.TOWN:GAME.obstacleTextures=this.townTextures,GAME.largeObstacleTextures=this.largeTownTextures}},GAME.ObstacleItem=function(){var e=GAME.obstacleTextures[Math2.randomInt(0,GAME.obstacleTextures.length-1)];PIXI.Sprite.call(this,PIXI.Texture.fromFrame(e)),this.anchor.x=0,this.anchor.y=1,this.isHit=0},GAME.ObstacleItem.constructor=GAME.ObstacleItem,GAME.ObstacleItem.prototype=Object.create(PIXI.Sprite.prototype),GAME.LargeObstacleItem=function(){var e=GAME.largeObstacleTextures[Math2.randomInt(0,GAME.largeObstacleTextures.length-1)];PIXI.Sprite.call(this,PIXI.Texture.fromFrame(e)),this.anchor.x=0,this.anchor.y=1,this.isHit=0,this.isLarge=1},GAME.LargeObstacleItem.constructor=GAME.LargeObstacleItem,GAME.LargeObstacleItem.prototype=Object.create(PIXI.Sprite.prototype),GAME.BackgroundManager=function(e){PIXI.DisplayObjectContainer.call(this),this.engine=e,this.backgrounds=[],this.nextbg=this.spawnCount=0,this.hasMiddistance=0,this.hasTrain=0,this.rangerDroppedOff=0,this.FLOOR_Y=339,this.width=1600,this.scrollPosition,this.scrollOffset=1e4,this.distance=new GAME.MultiTileBackgroundElement(["bg1.jpg","bg2.jpg","bg1.jpg","bg2.jpg"],this),this.distance.speed=.2,this.middistance=new PIXI.DisplayObjectContainer,this.addChild(this.middistance),this.middistance.speed=.4,this.train=new GAME.Train,this.train.position.y=171,this.train.speed=.08,this.backgroundFactory=new GAME.BackgroundFactory},GAME.BackgroundManager.constructor=GAME.BackgroundManager,GAME.BackgroundManager.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.BackgroundManager.prototype.updateTransform=function(){if(!GAME.gameover){this.scrollPosition=GAME.camera.x+this.scrollOffset,this.distance.setPosition(this.scrollPosition);for(var e=0;this.backgrounds.length>e;e++)obj=this.backgrounds[e],obj.position.x-=this.engine.player.speed.x*this.middistance.speed,obj.position.x<0-obj.width&&(this.backgroundFactory.backgroundPool.returnObject(obj),this.backgrounds.splice(e,1),e--,this.middistance.removeChild(obj));this.hasTrain&&(this.train.position.x-=this.engine.player.speed.x*this.train.speed,this.train.position.x<=this.engine.player.view.position.x&&!this.rangerDroppedOff&&(this.engine.foregroundManager.dropOffRanger(),this.rangerDroppedOff=!0)),this.spawnCount+=this.engine.player.speed.x*this.middistance.speed,this.hasMiddistance&&this.nextbg<this.spawnCount&&(this.spawnCount=0,this.addBackground(GAME.width+40,this.FLOOR_Y))}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},GAME.BackgroundManager.prototype.addBackground=function(e,t){var n=this.backgroundFactory.getBackground();n.position.x=e,n.position.y=t,this.backgrounds.push(n),this.middistance.addChild(n),this.nextbg=n.width},GAME.BackgroundManager.prototype.addTrain=function(){var e=this.backgroundFactory.getTrainStation();e.position.x=GAME.width+40,e.position.y=this.FLOOR_Y,this.backgrounds.push(e),this.middistance.addChild(e),this.nextbg=e.width,this.train.position.x=GAME.width+60,this.addChild(this.train),this.hasTrain=!0},GAME.BackgroundManager.prototype.reset=function(){for(var e=0;this.backgrounds.length>e;e++){var t=this.backgrounds[e];this.middistance.removeChild(t)}this.backgrounds=[],this.rangerDroppedOff=!1,this.train.reset(),this.hasTrain&&(this.removeChild(this.train),this.hasTrain=!1)},GAME.BackgroundElement=function(e,t,n){this.sprites=[],this.spriteWidth=e.width-1;var i=Math.ceil(940/this.spriteWidth);3>i&&(i=3);for(var r=0;i>r;r++){var o=new PIXI.Sprite(e);o.position.y=t,n.addChild(o),this.sprites.push(o)}this.speed=1},GAME.BackgroundElement.prototype.setPosition=function(e){for(var t=this.spriteWidth,n=0;this.sprites.length>n;n++){var i=-e*this.speed,i=i+n*t,i=i%(t*this.sprites.length),i=i+2*t;this.sprites[n].position.x=Math.floor(i)}},GAME.MultiTileBackgroundElement=function(e,t,n,i){n=n||0,i=i||0,this.sprites=[];for(var r=0;e.length>r;r++){var o=new PIXI.Sprite(PIXI.Texture.fromFrame(e[r]));o.position.y=i,t.addChild(o),this.sprites.push(o),n&&(o.anchor.y=1)}this.spriteWidth=o.width,this.speed=1},GAME.MultiTileBackgroundElement.constructor=GAME.MultiTileBackgroundElement,GAME.MultiTileBackgroundElement.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.MultiTileBackgroundElement.prototype.setPosition=function(e){for(var t=this.spriteWidth-1,n=0;this.sprites.length>n;n++){var i=-e*this.speed,i=i+n*t,i=i%(t*this.sprites.length),i=i+2*t;this.sprites[n].position.x=Math.floor(i)}},GAME.ForegroundManager=function(e){this.engine=e,this.obstacleMax=0,this.hasTrack=0,this.hasFloorGaps=0,this.hasPlatforms=0,this.hasLargeObjects=0,this.hasFloor=1,this.toNextGap=0,this.gapAdded=0,this.FLOOR_Y=329,this.FLOOR_GAP_WIDTH=350,this.objectPools={floor:[],track:[],obstacles:[],platforms:[]},this.floorPos=0,this.trackPos=0,this.platformPos=0,this.floorFactory=new GAME.FloorFactory,this.platformFactory=new GAME.PlatformFactory,this.obstacleFactory=new GAME.ObstacleFactory,this.initFloor()},GAME.ForegroundManager.constructor=GAME.ForegroundManager,GAME.ForegroundManager.prototype.initFloor=function(){for(var e=0;Math.ceil(GAME.width/this.floorFactory.getFloor().texture.width)+1>e;e++){var t=this.floorFactory.getFloor();t.position.x=this.floorPos,t.x=this.floorPos,t.position.y=this.FLOOR_Y,t.y=this.FLOOR_Y,this.engine.view.gameFG.addChild(t),this.objectPools.floor.push(t),this.floorPos+=t.width-1}},GAME.ForegroundManager.prototype.initTrack=function(){for(var e=0;Math.ceil(GAME.width/this.floorFactory.getTrack().texture.width)+1>e;e++){var t=this.floorFactory.getTrack();t.position.x=this.trackPos,t.x=this.trackPos,t.position.y=this.FLOOR_Y,t.y=this.FLOOR_Y,this.engine.view.gameMG.addChild(t),this.objectPools.track.push(t),this.trackPos+=t.width-1}this.hasTrack=1},GAME.ForegroundManager.prototype.update=function(){for(var e,t=0;this.objectPools.floor.length>t;t++)e=this.objectPools.floor[t],e.position.x=e.x-GAME.camera.x-100,e.position.x<0-e.width&&(this.floorFactory.floorPool.returnObject(e),this.objectPools.floor.splice(t,1),t--,this.engine.view.gameFG.removeChild(e));if(e.position.x+e.width<GAME.width+40*this.engine.player.speed.x){var n=null;1==this.gapAdded&&(n=this.floorFactory.getFloorCap("left"),n.position.x=Math.round(e.position.x+e.width-1),n.x=this.floorPos,n.position.y=this.FLOOR_Y,this.objectPools.floor.push(n),this.gapAdded=0);var i=this.floorFactory.getFloor();if(i.position.x=Math.round(e.position.x+e.width),i.x=this.floorPos,i.position.y=this.hasFloor?this.FLOOR_Y:this.FLOOR_Y+300,this.engine.view.gameFG.addChild(i),n&&this.engine.view.gameFG.addChild(n),this.objectPools.floor.push(i),this.floorPos+=i.width-1,1==this.hasFloorGaps){if(this.hasTrack){var r=this.floorFactory.getBridge();r.position.x=Math.round(i.position.x+i.width-1),r.x=this.floorPos-20,r.position.y=this.FLOOR_Y,this.engine.view.gameFG.addChild(r),this.objectPools.floor.push(r)}n=this.floorFactory.getFloorCap("right"),n.position.x=Math.round(i.position.x+i.width-1),n.x=this.floorPos,n.position.y=this.FLOOR_Y,this.engine.view.gameFG.addChild(n),this.objectPools.floor.push(n),this.floorPos+=this.hasTrack?Math2.randomInt(250,this.FLOOR_GAP_WIDTH):Math2.randomInt(200,this.FLOOR_GAP_WIDTH-100),this.gapAdded=1}if(!this.hasPlatforms){var o=0;if(2==this.obstacleMax){if(0==Math2.randomInt(0,1)){var s=Math2.randomInt(150,548);this.addObstacle(i.position.x+s,i.x+s,this.FLOOR_Y+5,!1),o++}if(0==Math2.randomInt(0,1)){var s=Math2.randomInt(698,1097);this.addObstacle(i.position.x+s,i.x+s,this.FLOOR_Y+5,!1),o++}}else if(1==this.obstacleMax&&0==Math2.randomInt(0,1)){var s=Math2.randomInt(150,1097);this.addObstacle(i.position.x+s,i.x+s,this.FLOOR_Y+5,!1),o++}if(this.hasLargeObjects&&0==o&&0==Math2.randomInt(0,2)){var s=Math2.randomInt(150,1097);this.addObstacle(i.position.x+s,i.x+s,this.FLOOR_Y+5,!0)}}}for(var t=0;this.objectPools.platforms.length>t;t++)e=this.objectPools.platforms[t],e.position.x=e.x-GAME.camera.x-100,e.position.x<0-e.width-100&&(this.platformFactory.platformPool.returnObject(e),this.objectPools.platforms.splice(t,1),t--,this.engine.view.gameFG.removeChild(e));GAME.camera.x+GAME.width+100>this.platformPos&&0!=this.platformPos&&1==this.hasPlatforms&&this.addPlatform();for(var t=0;this.objectPools.obstacles.length>t;t++)e=this.objectPools.obstacles[t],e.position.x=e.x-GAME.camera.x-100,e.position.x<0-e.width&&(this.obstacleFactory.obstaclePool.returnObject(e),this.objectPools.obstacles.splice(t,1),t--,this.engine.view.gameFG.removeChild(e));if(this.hasTrack){for(var t=0;this.objectPools.track.length>t;t++)e=this.objectPools.track[t],e.position.x=e.x-GAME.camera.x-100,e.position.x<0-e.width&&(this.floorFactory.trackPool.returnObject(e),this.objectPools.track.splice(t,1),t--,this.engine.view.gameMG.removeChild(e));if(e.position.x+e.width<GAME.width+40*this.engine.player.speed.x){var a=this.floorFactory.getTrack();a.position.x=Math.round(e.position.x+e.width),a.x=this.trackPos,a.position.y=this.FLOOR_Y,this.engine.view.gameMG.addChild(a),this.objectPools.track.push(a),this.trackPos+=a.width-1}}},GAME.ForegroundManager.prototype.addPlatform=function(){var e=Math2.randomInt(40,150),t=this.platformFactory.getPlatform();if(t.position.x=GAME.width+e,t.x=this.platformPos+e,this.hasFloor)t.position.y=this.FLOOR_Y+5;else{var n=Math2.randomInt(-50,50);t.position.y=GAME.height+n}this.engine.view.gameFG.addChild(t),this.objectPools.platforms.push(t),this.platformPos=t.x+t.width+e;for(var i=0;Math2.randomInt(0,this.obstacleMax)>i;i++){var r=Math2.randomInt(100,t.width-150);this.addObstacle(t.position.x+r,t.x+r,t.position.y-t.hitHeight+5,!1)}},GAME.ForegroundManager.prototype.addStepUp=function(){var e=this.platformFactory.getStepUp(),t=e.step1;t.position.x=GAME.width+40,t.x=this.floorPos-80,t.position.y=this.FLOOR_Y+5;var n=e.step2;n.position.x=t.position.x+t.width+10,n.x=t.x+t.width+10,n.position.y=this.FLOOR_Y+5,this.engine.view.gameFG.addChild(t),this.objectPools.platforms.push(t),this.engine.view.gameFG.addChild(n),this.objectPools.platforms.push(n),this.platformPos=n.x+n.width},GAME.ForegroundManager.prototype.addObstacle=function(e,t,n,i){var r;r=i?this.obstacleFactory.getLargeObstacle():this.obstacleFactory.getObstacle(),r.position.x=e,r.x=t,r.position.y=n,this.objectPools.obstacles.push(r),this.engine.view.gameFG.addChild(r)},GAME.ForegroundManager.prototype.addRanger=function(){var e=new PIXI.Sprite(PIXI.Texture.fromFrame("ranger_village.png"));e.anchor.x=0,e.anchor.y=1,e.position.x=GAME.width+40,e.position.y=this.FLOOR_Y+8,e.x=this.floorPos+200,e.isRanger=!0,this.engine.view.gameFG.addChild(e),this.objectPools.obstacles.push(e)},GAME.ForegroundManager.prototype.pickupRanger=function(){this.engine.view.flashScreen(),this.engine.player.pickupRanger()},GAME.ForegroundManager.prototype.dropOffRanger=function(){this.engine.view.flashScreen(),this.engine.player.dropOffRanger(),this.engine.view.backgroundManager.train.ranger.alpha=1},GAME.ForegroundManager.prototype.resetFloor=function(){this.hasFloor=1;for(var e=0;this.objectPools.floor.length>e;e++)this.objectPools.floor[e].position.y=this.FLOOR_Y},GAME.ForegroundManager.prototype.reset=function(){for(var e=0;this.objectPools.floor.length>e;e++){var t=this.objectPools.floor[e];this.engine.view.gameFG.removeChild(t)}this.objectPools.floor=[];for(var e=0;this.objectPools.obstacles.length>e;e++){var t=this.objectPools.obstacles[e];this.engine.view.gameFG.removeChild(t)}this.objectPools.obstacles=[];for(var e=0;this.objectPools.platforms.length>e;e++){var t=this.objectPools.platforms[e];this.engine.view.gameFG.removeChild(t)}this.objectPools.platforms=[];for(var e=0;this.objectPools.track.length>e;e++){var t=this.objectPools.track[e];this.engine.view.gameMG.removeChild(t)}this.objectPools.track=[],this.floorPos=0,this.trackPos=0,this.initFloor()},GAME.CollisionManager=function(e){this.engine=e},GAME.CollisionManager.constructor=GAME.CollisionManager,GAME.CollisionManager.prototype.update=function(){this.engine.player.onGround=0,this.engine.player.dead||(this.playerVsObstacle(),this.playerVsPlatform(),this.playerVsFloor())},GAME.CollisionManager.prototype.playerVsObstacle=function(){for(var e=this.engine.foregroundManager.objectPools.obstacles,t=this.engine.player,n=0;e.length>n;n++)if(!e[n].isHit){var i=this.calculateIntersection(this.getPlayerBounds(),new PIXI.Rectangle(e[n].x,e[n].position.y-e[n].height,e[n].width,e[n].height),t.speed.x,t.speed.y);i&&(e[n].isLarge&&i.height>30?(e[n].isHit=1,t.hitWall()):e[n].isRanger?(e[n].isHit=!0,e[n].alpha=0,this.engine.foregroundManager.pickupRanger()):(e[n].isHit=1,t.hitObstacle(),TweenMax.to(e[n],.6,{alpha:0}),TweenMax.to(e[n].position,.2,{x:e[n].position.x+30,y:e[n].position.y-10,yoyo:!0,repeat:1})))}},GAME.CollisionManager.prototype.playerVsPlatform=function(){for(var e=this.engine.foregroundManager.objectPools.platforms,t=this.engine.player,n=0;e.length>n;n++){var i=this.calculateIntersection(this.getPlayerBounds(),new PIXI.Rectangle(e[n].x+40,e[n].position.y-e[n].hitHeight,e[n].width-40,e[n].hitHeight),t.speed.x,t.speed.y);if(i&&!t.isJumping){if(!(i.height-t.speed.y>35)){(t.wasJumping||t.isFalling)&&t.jumpComplete(),t.speed.y=0,t.position.y-=Math.round(i.height)-4,t.onGround=1;break}t.hitWall()}}},GAME.CollisionManager.prototype.playerVsFloor=function(){for(var e=this.engine.foregroundManager.objectPools.floor,t=this.engine.player,n=0;e.length>n;n++)if(e[n].collidable){var i=this.calculateIntersection(this.getPlayerBounds(),new PIXI.Rectangle(e[n].x,e[n].position.y,e[n].width,e[n].height),t.speed.x,t.speed.y);if(i&&!t.isJumping){if(!(i.height-t.speed.y>40)){(t.wasJumping||t.isFalling)&&t.jumpComplete(),t.onGround=1,t.speed.y=0,t.position.y-=Math.round(i.height)-4;break}t.speed.x=0,t.position.x-=Math.round(i.width)}}},GAME.CollisionManager.prototype.getPlayerBounds=function(){var e=this.engine.player,t=new PIXI.Rectangle(e.position.x+60,e.position.y-e.height,60,70);return t},GAME.CollisionManager.prototype.calculateIntersection=function(e,t,n,i){n=n||0,i=i||0;var r,o,s={},a={};return s.cx=e.x+n+(s.hw=e.width/2),s.cy=e.y+i+(s.hh=e.height/2),a.cx=t.x+(a.hw=t.width/2),a.cy=t.y+(a.hh=t.height/2),r=Math.abs(s.cx-a.cx)-(s.hw+a.hw),o=Math.abs(s.cy-a.cy)-(s.hh+a.hh),0>r&&0>o?{width:-r,height:-o}:null},GAME.SectionManager=function(e){this.engine=e},GAME.SectionManager.constructor=GAME.SectionManager,GAME.SectionManager.prototype.update=function(){var e=Math.round((GAME.camera.x+140)/10);if(e>GAME_MILESTONES[GAME.level])switch(GAME.level++,GAME.level){case GAME_LEVEL.TUTORIAL:GAME.seenTutorial?this.setMilestones():(this.engine.player.cutScene=1,GAME.tutorial=1,this.engine.view.hud.addChild(this.engine.view.tutorial));break;case GAME_LEVEL.DESERT:this.engine.view.progressbar.startTime(),this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.GO_VILLAGE)),this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.DESERT),this.engine.view.backgroundManager.hasMiddistance=0,this.engine.foregroundManager.obstacleMax=2,this.engine.foregroundManager.hasLargeObjects=1;break;case GAME_LEVEL.DESERT_GAPS:this.engine.foregroundManager.hasFloorGaps=1,this.engine.foregroundManager.obstacleMax=1,this.engine.foregroundManager.hasLargeObjects=0;break;case GAME_LEVEL.DESERT_PREVILLAGE:this.engine.foregroundManager.hasFloorGaps=0,this.engine.foregroundManager.obstacleMax=2,this.engine.foregroundManager.hasLargeObjects=1;break;case GAME_LEVEL.INDIAN_VILLAGE:this.engine.view.backgroundManager.hasMiddistance=1,this.engine.view.backgroundManager.backgroundFactory.setTextures(GAME_LEVEL.INDIAN_VILLAGE),this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.INDIAN_VILLAGE);break;case GAME_LEVEL.INDIAN_VILLAGE_RANGER:this.engine.foregroundManager.addRanger(),this.engine.tonto.catchUp(),this.engine.foregroundManager.hasLargeObjects=0,this.engine.foregroundManager.obstacleMax=0;break;case GAME_LEVEL.DESERT_INTERLUDE:this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.GO_TRAIN)),this.engine.view.backgroundManager.hasMiddistance=0,this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.DESERT),this.engine.foregroundManager.hasLargeObjects=1,this.engine.foregroundManager.obstacleMax=2;break;case GAME_LEVEL.TOWN:this.engine.view.backgroundManager.hasMiddistance=1,this.engine.view.backgroundManager.backgroundFactory.setTextures(GAME_LEVEL.TOWN),this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.TOWN);break;case GAME_LEVEL.TOWN_ROOFTOPS:this.engine.foregroundManager.obstacleMax=0,this.engine.foregroundManager.hasLargeObjects=0,this.engine.view.backgroundManager.hasMiddistance=1,this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.TOWN),this.engine.view.backgroundManager.backgroundFactory.setTextures(GAME_LEVEL.TOWN),this.engine.foregroundManager.platformFactory.setTextures(GAME_LEVEL.TOWN),this.engine.foregroundManager.hasPlatforms=1,this.engine.foregroundManager.addStepUp(),this.engine.tonto.fallBack();break;case GAME_LEVEL.TRAIN_STATION:this.engine.view.backgroundManager.hasMiddistance=0,this.engine.foregroundManager.obstacleMax=0,this.engine.foregroundManager.hasPlatforms=0,this.engine.foregroundManager.initTrack(),this.engine.view.backgroundManager.addTrain(),this.engine.view.backgroundManager.train.speed=.05,this.engine.tonto.catchUp();break;case GAME_LEVEL.TRAIN_CHASE:this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.CATCH_TRAIN)),this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.DESERT),this.engine.foregroundManager.obstacleMax=1,this.engine.foregroundManager.hasFloorGaps=1,this.engine.tonto.fallBack();break;case GAME_LEVEL.TRAIN_RANGER:this.engine.foregroundManager.hasFloorGaps=0;break;case GAME_LEVEL.CANYONS:this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.GO_FRONT)),this.engine.foregroundManager.obstacleMax=1,this.engine.view.backgroundManager.backgroundFactory.setTextures(GAME_LEVEL.CANYONS),this.engine.foregroundManager.platformFactory.setTextures(GAME_LEVEL.CANYONS),this.engine.foregroundManager.hasPlatforms=1,this.engine.foregroundManager.addStepUp(),this.engine.foregroundManager.hasFloor=0,this.engine.foregroundManager.hasTrack=0,this.engine.view.backgroundManager.train.speed=.09;break;case GAME_LEVEL.CANYONS_INTERLUDE:this.engine.foregroundManager.resetFloor(),this.engine.foregroundManager.hasPlatforms=0,this.engine.foregroundManager.obstacleMax=0,this.engine.foregroundManager.hasTrack=1,this.engine.tonto.catchUp();break;case GAME_LEVEL.DESERT_TRAIN:this.engine.view.hud.addChild(new GAME.Message(GAME.LOCALISED.DONE,!0)),this.engine.view.backgroundManager.train.ranger2.alpha=1,this.engine.view.backgroundManager.train.speed=0,this.engine.view.progressbar.stopTime(),this.engine.view.backgroundManager.train.slowDown(),this.engine.view.backgroundManager.train.speed=0,this.engine.player.cutScene=1,TweenMax.delayedCall(3,this.engine.onGameComplete,null,this.engine)}},GAME.SectionManager.prototype.reset=function(){this.engine.foregroundManager.obstacleFactory.setTextures(GAME_LEVEL.DESERT),this.engine.view.backgroundManager.hasMiddistance=0,this.engine.foregroundManager.hasFloorGaps=0,this.engine.foregroundManager.obstacleMax=0,this.engine.foregroundManager.hasPlatforms=0,this.engine.foregroundManager.hasLargeObjects=0,this.engine.foregroundManager.hasFloor=1,this.engine.foregroundManager.hasTrack=0},GAME.SectionManager.prototype.setMilestones=function(){GAME_MILESTONES[1]=GAME_MILESTONES[0]+Math.round((GAME.camera.x+140)/10)+250,GAME_MILESTONES[2]=GAME_MILESTONES[1]+800,GAME_MILESTONES[3]=GAME_MILESTONES[2]+800,GAME_MILESTONES[4]=GAME_MILESTONES[3]+600,GAME_MILESTONES[5]=GAME_MILESTONES[4]+400,GAME_MILESTONES[6]=GAME_MILESTONES[5]+200,GAME_MILESTONES[7]=GAME_MILESTONES[6]+500,GAME_MILESTONES[8]=GAME_MILESTONES[7]+800,GAME_MILESTONES[9]=GAME_MILESTONES[8]+1e3,GAME_MILESTONES[10]=GAME_MILESTONES[9]+200,GAME_MILESTONES[11]=GAME_MILESTONES[10]+1e3,GAME_MILESTONES[12]=GAME_MILESTONES[11]+400,GAME_MILESTONES[13]=GAME_MILESTONES[12]+1e3,GAME_MILESTONES[14]=GAME_MILESTONES[13]+400,GAME_MILESTONES[15]=GAME_MILESTONES[14]+100,GAME.GOAL_DISTANCE=GAME_MILESTONES[15]-GAME_MILESTONES[1]};var GAME_LEVEL={START:0,TUTORIAL:1,DESERT:2,DESERT_GAPS:3,DESERT_PREVILLAGE:4,INDIAN_VILLAGE:5,INDIAN_VILLAGE_RANGER:6,DESERT_INTERLUDE:7,TOWN:8,TOWN_ROOFTOPS:9,TRAIN_STATION:10,TRAIN_CHASE:11,TRAIN_RANGER:12,CANYONS:13,CANYONS_INTERLUDE:14,DESERT_TRAIN:15},GAME_MILESTONES={};GAME_MILESTONES[0]=0,GAME_MILESTONES[1]=GAME_MILESTONES[0]+9999999999,GAME.GOAL_DISTANCE=GAME_MILESTONES[1],GAME.ObjectPool=function(e){this.classType=e,this.pool=[]},GAME.ObjectPool.constructor=GAME.ObjectPool,GAME.ObjectPool.prototype.getObject=function(){var e=this.pool.pop();return e||(e=new this.classType),e},GAME.ObjectPool.prototype.returnObject=function(){},GAME.GameOver=function(e){PIXI.DisplayObjectContainer.call(this);var t=this;this.engine=e,this.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame("game_over_fail.jpg")));var n=new PIXI.Text(GAME.LOCALISED.MISSION,{font:"25px Anton",fill:"#ffffff"});n.anchor.x=1,n.position.x=540,n.position.y=65,GAME.isFireFox&&(n.position.y+=6),this.addChild(n);var i=new PIXI.Text(GAME.LOCALISED.FAILED,{font:"46px Anton",fill:"#ffffff"});i.position.x=545,i.position.y=52,GAME.isFireFox&&(i.position.y+=14),this.addChild(i);var r=new PIXI.Text(GAME.LOCALISED.DISTANCE.toUpperCase()+":",{font:"25px Anton",fill:"#000000"});r.position.x=526,r.position.y=152,GAME.isFireFox&&(r.position.y+=8),r.anchor.x=1,this.addChild(r),this.percText=new PIXI.Text("0",{font:"70px Anton",fill:"#f26825"}),this.percText.position.x=530,this.percText.position.y=116,GAME.isFireFox&&(this.percText.position.y+=26),this.addChild(this.percText),this.percSymbol=new PIXI.Text("%",{font:"40px Anton",fill:"#f26825"}),this.percSymbol.position.x=this.percText.position.x+this.percText.width+2,this.percSymbol.position.y=148,GAME.isFireFox&&(this.percSymbol.position.y+=16),this.addChild(this.percSymbol);var o=new PIXI.Text(GAME.LOCALISED.SHARE,{font:"18px Anton",fill:"#ffffff"});o.position.x=460,o.position.y=238,GAME.isFireFox&&(o.position.y+=5),this.addChild(o),this.facebook=new PIXI.Sprite(PIXI.Texture.fromFrame("facebook_off.png")),this.facebook.position.x=565,this.facebook.position.y=234,this.addChild(this.facebook),this.facebook.setInteractive(!0),this.facebook.buttonMode=!0,this.facebook.mousedown=this.facebook.touchstart=function(e){t.handleFacebook(e)},GAME.isMobile||(this.facebook.mouseover=function(){t.facebook.setTexture(PIXI.Texture.fromFrame("facebook_on.png"))},this.facebook.mouseout=function(){t.facebook.setTexture(PIXI.Texture.fromFrame("facebook_off.png"))}),this.twitter=new PIXI.Sprite(PIXI.Texture.fromFrame("twitter_off.png")),this.twitter.position.x=617,this.twitter.position.y=232,this.addChild(this.twitter),this.twitter.setInteractive(!0),this.twitter.buttonMode=!0,this.twitter.mousedown=this.twitter.touchstart=function(e){t.handleTwitter(e)},GAME.isMobile||(this.twitter.mouseover=function(){t.twitter.setTexture(PIXI.Texture.fromFrame("twitter_on.png"))},this.twitter.mouseout=function(){t.twitter.setTexture(PIXI.Texture.fromFrame("twitter_off.png"))});var s=new PIXI.DisplayObjectContainer,a=new PIXI.Sprite(PIXI.Texture.fromFrame("trailer_button.png"));a.position.x=20,s.addChild(a),this.trailerHighlight=new PIXI.Sprite(PIXI.Texture.fromFrame("trailer_off.png")),this.trailerHighlight.position.y=83,s.addChild(this.trailerHighlight);var l=new PIXI.Text(GAME.LOCALISED.WATCH_TRAILER,{font:"18px Anton",fill:"#ffffff"});l.position.x=40,l.position.y=88,GAME.isFireFox&&(l.position.y+=5),s.addChild(l),s.position.x=290,s.position.y=280,this.addChild(s),s.setInteractive(!0),s.buttonMode=!0,s.mousedown=s.touchstart=function(e){t.handleTrailer(e)},GAME.isMobile||(s.mouseover=function(){t.trailerHighlight.setTexture(PIXI.Texture.fromFrame("trailer_on.png"))},s.mouseout=function(){t.trailerHighlight.setTexture(PIXI.Texture.fromFrame("trailer_off.png"))});var c=new PIXI.DisplayObjectContainer;c.position.x=499,c.position.y=287,this.playButtonBG=new PIXI.Sprite(PIXI.Texture.fromFrame("play_off.png")),c.addChild(this.playButtonBG);var u=new PIXI.Text(GAME.LOCALISED.TRY_AGAIN,{font:"40px Anton",fill:"#ffffff"});u.position.x=70,u.position.y=7,GAME.isFireFox&&(u.position.y+=14),c.addChild(u);var h=new PIXI.Sprite(PIXI.Texture.fromFrame("play_button.png"));h.position.x=u.position.x+u.width+10,h.position.y=19,c.addChild(h),this.addChild(c),c.setInteractive(!0),c.buttonMode=!0,c.mousedown=c.touchstart=function(e){t.handlePlay(e)},GAME.isMobile||(c.mouseover=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_on.png"))},c.mouseout=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_off.png"))})},GAME.GameOver.constructor=GAME.GameOver,GAME.GameOver.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.GameOver.prototype.setProgress=function(e){this.percText.setText(e.toFixed(1)),this.percText.updateText(),this.percSymbol.position.x=this.percText.position.x+this.percText.width+2},GAME.GameOver.prototype.handleFacebook=function(){var e=GAME.LOCALISED.FACEBOOK_SHARE.replace("{{result}}",this.percText.text+"%");window.open(e,"_blank"),ga("send","event","Game","Facebook Share","Game Over")},GAME.GameOver.prototype.handleTwitter=function(){var e=GAME.LOCALISED.TWITTER_SHARE.replace("{{result}}",this.percText.text+"%25");
window.open(e,"_blank"),ga("send","event","Game","Twitter Share","Game Over")},GAME.GameOver.prototype.handlePlay=function(){this.engine.reset(),ga("send","event","Game","Play","Game Over")},GAME.GameOver.prototype.handleTrailer=function(){GAME.openTrailer(),ga("send","event","Game","Trailer","Game Over")},GAME.GameComplete=function(e){PIXI.DisplayObjectContainer.call(this);var t=this;this.engine=e,this.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame("game_over_win.jpg")));var n=new PIXI.Text(GAME.LOCALISED.MISSION,{font:"25px Anton",fill:"#ffffff"});n.position.x=540,n.position.y=65,n.anchor.x=1,GAME.isFireFox&&(n.position.y+=6),this.addChild(n);var i=new PIXI.Text(GAME.LOCALISED.COMPLETE,{font:"46px Anton",fill:"#ffffff"});i.position.x=545,i.position.y=52,GAME.isFireFox&&(i.position.y+=14),this.addChild(i);var r=new PIXI.Text(GAME.LOCALISED.TIME.toUpperCase()+":",{font:"25px Anton",fill:"#000000"});r.position.x=506,r.position.y=152,GAME.isFireFox&&(r.position.y+=6),r.anchor.x=1,this.addChild(r),this.resultText=new PIXI.Text("0:00",{font:"74px Anton",fill:"#f26825"}),this.resultText.position.x=510,this.resultText.position.y=114,GAME.isFireFox&&(this.resultText.position.y+=26),this.addChild(this.resultText);var o=new PIXI.Text(GAME.LOCALISED.SHARE,{font:"18px Anton",fill:"#ffffff"});o.position.x=460,o.position.y=238,GAME.isFireFox&&(o.position.y+=5),this.addChild(o),this.facebook=new PIXI.Sprite(PIXI.Texture.fromFrame("facebook_off.png")),this.facebook.position.x=565,this.facebook.position.y=234,this.addChild(this.facebook),this.facebook.setInteractive(!0),this.facebook.buttonMode=!0,this.facebook.mousedown=this.facebook.touchstart=function(e){t.handleFacebook(e)},GAME.isMobile||(this.facebook.mouseover=function(){t.facebook.setTexture(PIXI.Texture.fromFrame("facebook_on.png"))},this.facebook.mouseout=function(){t.facebook.setTexture(PIXI.Texture.fromFrame("facebook_off.png"))}),this.twitter=new PIXI.Sprite(PIXI.Texture.fromFrame("twitter_off.png")),this.twitter.position.x=617,this.twitter.position.y=232,this.addChild(this.twitter),this.twitter.setInteractive(!0),this.twitter.buttonMode=!0,this.twitter.mousedown=this.twitter.touchstart=function(e){t.handleTwitter(e)},GAME.isMobile||(this.twitter.mouseover=function(){t.twitter.setTexture(PIXI.Texture.fromFrame("twitter_on.png"))},this.twitter.mouseout=function(){t.twitter.setTexture(PIXI.Texture.fromFrame("twitter_off.png"))});var s=new PIXI.DisplayObjectContainer,a=new PIXI.Sprite(PIXI.Texture.fromFrame("trailer_button.png"));a.position.x=20,s.addChild(a),this.trailerHighlight=new PIXI.Sprite(PIXI.Texture.fromFrame("trailer_off.png")),this.trailerHighlight.position.y=83,s.addChild(this.trailerHighlight);var l=new PIXI.Text(GAME.LOCALISED.WATCH_TRAILER,{font:"18px Anton",fill:"#ffffff"});l.position.x=40,l.position.y=88,GAME.isFireFox&&(l.position.y+=5),s.addChild(l),s.position.x=290,s.position.y=280,this.addChild(s),s.setInteractive(!0),s.buttonMode=!0,s.mousedown=s.touchstart=function(e){t.handleTrailer(e)},GAME.isMobile||(s.mouseover=function(){t.trailerHighlight.setTexture(PIXI.Texture.fromFrame("trailer_on.png"))},s.mouseout=function(){t.trailerHighlight.setTexture(PIXI.Texture.fromFrame("trailer_off.png"))});var c=new PIXI.DisplayObjectContainer;c.position.x=499,c.position.y=287,this.playButtonBG=new PIXI.Sprite(PIXI.Texture.fromFrame("play_off.png")),c.addChild(this.playButtonBG);var u=new PIXI.Text(GAME.LOCALISED.REPLAY,{font:"40px Anton",fill:"#ffffff"});u.position.x=70,u.position.y=7,GAME.isFireFox&&(u.position.y+=14),c.addChild(u);var h=new PIXI.Sprite(PIXI.Texture.fromFrame("play_button.png"));h.position.x=u.position.x+u.width+10,h.position.y=19,c.addChild(h),this.addChild(c),c.setInteractive(!0),c.buttonMode=!0,c.mousedown=c.touchstart=function(e){t.handlePlay(e)},GAME.isMobile||(c.mouseover=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_on.png"))},c.mouseout=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_off.png"))})},GAME.GameComplete.constructor=GAME.GameComplete,GAME.GameComplete.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.GameComplete.prototype.setTime=function(e){this.resultText.setText(e)},GAME.GameComplete.prototype.handleFacebook=function(){var e=GAME.LOCALISED.FACEBOOK_SHARE.replace("{{result}}",this.resultText.text);window.open(e,"_blank"),ga("send","event","Game","Facebook Share","Game Complete")},GAME.GameComplete.prototype.handleTwitter=function(){var e=GAME.LOCALISED.TWITTER_SHARE.replace("{{result}}",this.resultText.text);window.open(e,"_blank"),ga("send","event","Game","Twitter Share","Game Complete")},GAME.GameComplete.prototype.handlePlay=function(){this.engine.reset(),ga("send","event","Game","Play","Game Complete")},GAME.GameComplete.prototype.handleTrailer=function(){GAME.openTrailer(),ga("send","event","Game","Trailer","Game Complete")},GAME.Title=function(e){PIXI.DisplayObjectContainer.call(this);var t=this;this.engine=e,this.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame("title_screen.jpg")));var n=new PIXI.DisplayObjectContainer;this.playButtonBG=new PIXI.Sprite(PIXI.Texture.fromFrame("play_off.png")),n.addChild(this.playButtonBG),n.position.x=499,n.position.y=287;var i=new PIXI.Text(GAME.LOCALISED.PLAY,{font:"40px Anton",fill:"#ffffff",align:"left"});i.position.x=90,i.position.y=9,GAME.isFireFox&&(i.position.y+=13),n.addChild(i);var r=new PIXI.Sprite(PIXI.Texture.fromFrame("play_button.png"));r.position.x=i.position.x+i.width+10,r.position.y=20,n.addChild(r),this.addChild(n),n.setInteractive(!0),n.buttonMode=!0,n.mousedown=n.touchstart=function(e){t.handlePlay(e)},GAME.isMobile||(n.mouseover=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_on.png"))},n.mouseout=function(){t.playButtonBG.setTexture(PIXI.Texture.fromFrame("play_off.png"))})},GAME.Title.constructor=GAME.Title,GAME.Title.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),GAME.Title.prototype.handlePlay=function(){this.engine.reset(),ga("send","event","Game","Play","Title Screen")},GAME.Engine=function(){GAME.level=GAME_LEVEL.START,GAME.tutorial=0,GAME.seenTutorial=0,this.player=new GAME.Player(this),this.tonto=new GAME.Tonto(this),this.view=new GAME.View(this),this.foregroundManager=new GAME.ForegroundManager(this),this.collisionManager=new GAME.CollisionManager(this),this.sectionManager=new GAME.SectionManager(this),this.soundManager=new GAME.SoundManager,this.view.gameFG.addChild(this.tonto.view),this.view.playerHolder.addChild(this.player.view),this.gameoverScreen=new GAME.GameOver(this),this.gamecompleteScreen=new GAME.GameComplete(this),this.titleScreen=new GAME.Title(this),this.view.screens.addChild(this.titleScreen),this.soundManager.playMusic("intro-music")},GAME.Engine.constructor=GAME.Engine,GAME.Engine.prototype.update=function(){GAME.pause||(GAME.gameover||(this.player.update(),this.collisionManager.update(),this.foregroundManager.update(),this.sectionManager.update(),200>this.player.position.y&&!this.view.platformView&&this.view.toPlatformView(),this.player.position.y>GAME.height-200&&this.view.platformView&&this.view.toNormalView()),this.view.update())},GAME.Engine.prototype.reset=function(){this.view.screens.removeChild(this.view.screens.getChildAt(0)),this.view.progressbar.reset(),this.view.progressbar.show(),this.player.reset(),this.tonto.reset(),this.view.reset(),this.foregroundManager.reset(),this.sectionManager.reset(),GAME.level=GAME_LEVEL.START,GAME.counter=0,GAME.gameover=0,this.soundManager.playMusic("game-music")},GAME.Engine.prototype.onGameOver=function(){this.soundManager.playSound("gameover-sound");var e=Math.round(this.player.position.x/10-GAME_MILESTONES[1]),t=100*(e/GAME.GOAL_DISTANCE);this.gameoverScreen.setProgress(t),GAME.gameover=1,this.view.progressbar.hide(),this.view.fade.addChild(this.view.blackFill),this.view.screens.addChild(this.gameoverScreen),this.soundManager.playMusic("failed-music")},GAME.Engine.prototype.onGameComplete=function(){this.soundManager.playSound("gameover-sound");var e=this.view.progressbar.timeDisplay.text;this.gamecompleteScreen.setTime(e),GAME.gameover=1,this.view.progressbar.hide(),this.view.fade.addChild(this.view.blackFill),this.view.screens.addChild(this.gamecompleteScreen),this.soundManager.playMusic("complete-music"),ga("send","event","Game","Complete")},GAME.Engine.prototype.onTouch=function(){GAME.pause||(GAME.tutorial?this.view.tutorial.skip():this.player.jump())};